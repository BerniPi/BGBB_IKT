<%- include('partials/header') %>
<%- include('partials/navbar', { page }) %>

<div class="container-fluid mt-4">
    <div class="p-3">
        <h3>Stammdaten verwalten</h3>
        <p class="text-muted">Hier können die grundlegenden Daten der Anwendung wie Räume, Gerätemodelle und Kategorien verwaltet werden.</p>

        <div class="accordion" id="settingsAccordion">

            <%# --- Räume Akkordeon --- %>
            <div class="accordion-item">
                <h2 class="accordion-header">
                     <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRooms">
                        <i class="bi bi-door-open-fill me-2"></i> Räume
                    </button>
                </h2>
                <div id="collapseRooms" class="accordion-collapse collapse" data-bs-parent="#settingsAccordion">
                    <div class="accordion-body">
                         <%# Raum Formular %>
                        <form id="roomForm" class="row g-3 mb-4 p-3 border rounded bg-light align-items-end">
                             <input type="hidden" id="room-room_id">
                             <div class="col-md-2"><label class="form-label">Nummer*</label><input type="text" class="form-control" id="room-room_number" required></div>
                             <div class="col-md-3"><label class="form-label">Name*</label><input type="text" class="form-control" id="room-room_name" required></div>
                             <div class="col-md-2"><label class="form-label">Etage</label><input type="number" class="form-control" id="room-floor"></div>
                             <div class="col-md-3"><label class="form-label">Sortierung</label><input type="number" class="form-control" id="room-sort_order" placeholder="Auto"></div>
                             <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">Speichern</button></div>
                        </form>
                         <%# Raum Tabelle %>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th style="width: 5%;">Sort</th> <%# Pfeile %>
                                        <th style="width: 15%;">Nummer</th>
                                        <th style="width: 30%;">Name</th>
                                        <th style="width: 10%;">Etage</th>
                                         <th style="width: 10%;">Sort#</th> <%# Angezeigte Sortiernummer %>
                                        <th style="width: 15%;">Aktion</th>
                                    </tr>
                                </thead>
                                <tbody id="rooms-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <%# --- Modelle Akkordeon (ANGEPASST) --- %>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseModels">
                        <i class="bi bi-laptop me-2"></i> Gerätemodelle
                    </button>
                </h2>
                <div id="collapseModels" class="accordion-collapse collapse" data-bs-parent="#settingsAccordion">
                    <div class="accordion-body">
                     <%# Modell Formular (ANGEPASST) %>
                   <form id="modelForm" class="row g-3 mb-4 p-3 border rounded bg-light align-items-end">
    <input type="hidden" id="model-model_id">
    <%# Erste Zeile %>
    <div class="col-md-2"><label class="form-label">Kategorie*</label><select id="model-category_id" class="form-select" required></select></div>
    <div 
class="col-md-2"><label class="form-label">Hersteller</label><input type="text" id="model-manufacturer" class="form-control" placeholder="z.B. HP"></div>
    <div class="col-md-2"><label class="form-label">Type</label><input type="text" id="model-type" class="form-control" placeholder="z.B.
Laptop"></div>

    <div class="col-md-3"><label class="form-label">Modellname</label><input type="text" id="model-model_name" class="form-control" placeholder="z.B.
EliteBook 840"></div>

    <div class="col-md-2"><label class="form-label">Modellnummer*</label><input type="text" id="model-model_number" class="form-control" required></div>

    <div class="col-md-1"><label class="form-label">Netzwerk</label><select id="model-has_network" class="form-select"><option value="0">Nein</option><option value="1">Ja</option></select></div>

    <%# Zweite Zeile für neue Felder (Layout angepasst) %>
    <div class="col-md-3"><label class="form-label">Kaufdatum</label><input type="date" id="model-purchase_date" class="form-control"></div>
    <div class="col-md-3"><label class="form-label">Preis (€)</label><input type="number" step="0.01" min="0" id="model-price" class="form-control" placeholder="z.B.
1499.99"></div>
    <div class="col-md-2"><label class="form-label">Garantie (Mon.)</label><input type="number" min="0" id="model-warranty_months" class="form-control" placeholder="z.B.
24"></div>

    <div class="col-md-2"><label class="form-label">Wartung (Mon.)</label><input type="number" min="0" id="model-maintenance_interval_months" class="form-control" placeholder="z.B. 12"></div>
    <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">Speichern</button></div>
</form>
                         <%# Modell Tabelle (ANGEPASST) %>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Kategorie</th>
                                        <th>Hersteller</th>
                                        <th>Type</th>
                                        <th>Modellname</th>
                                        <th>Modellnummer</th>
                                        <th>Geräte (Aktiv/Gesamt)</th>
                                        <th>Netzwerk</th> <%# Icon statt Text %>
                                        <th>Kaufdatum</th>
                                        <th>Preis (€)</th>
                                        <th>Garantie (Mon.)</th>
                                        <th>Wartungsint. (Mon.)</th>
                                        <th style="width: 15%;">Aktion</th>
                                    </tr>
                                </thead>
                                <tbody id="models-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <%# --- Kategorien Akkordeon --- %>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDeviceCats">
                         <i class="bi bi-tags-fill me-2"></i> Gerätekategorien
                    </button>
                </h2>
                <div id="collapseDeviceCats" class="accordion-collapse collapse" data-bs-parent="#settingsAccordion">
                    <div class="accordion-body">
                         <%# Kategorie Formular %>
                         <form id="deviceCategoryForm" class="row g-3 mb-4 p-3 border rounded bg-light align-items-end">
                            <input type="hidden" id="cat-category_id">
                            <div class="col-md-5"><label class="form-label">Name*</label><input type="text" class="form-control" id="cat-category_name" required></div>
                            <div class="col-md-5"><label class="form-label">Beschreibung</label><input type="text" class="form-control" id="cat-description"></div>
                            <div class="col-md-2"><button type="submit" class="btn btn-primary w-100">Speichern</button></div>
                        </form>
                         <%# Kategorie Tabelle %>
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead><tr><th>Name</th><th>Beschreibung</th><th style="width: 15%;">Aktion</th></tr></thead>
                                <tbody id="device-categories-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<%- include('partials/footer') %>
<%# Wichtig: devices.js für Hilfsfunktionen (cents <-> euros) laden %>
<script src="/js/devices.js"></script>
<script src="/js/master-data.js"></script>