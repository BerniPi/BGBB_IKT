<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventardatenbank</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<style>
/* NEU: Globale Schriftgröße für die gesamte Anwendung reduzieren 
html {
    font-size: 0.85rem; 
}
*/
.modal-dialog-scrollable .modal-body {
  overflow-y: auto !important;
  max-height: calc(100vh - var(--bs-modal-margin) * 2 - 120px);
}
.modal {
  overflow-x: hidden;
}

/* Mobil: sicherstellen, dass Body sauber scrollt und Footer sichtbar bleibt */
@media (max-width: 576px) {
  #deviceModal .modal-content {
    height: 100dvh;           /* dynamische Höhe inkl. Mobile-URL-Bar */
    display: flex;
    flex-direction: column;
  }
  #deviceModal .modal-body {
    flex: 1 1 auto;
    overflow-y: auto;
  }
  #deviceModal .modal-footer {
    position: sticky;
    bottom: 0;
    background: var(--bs-body-bg);
    box-shadow: 0 -2px 8px rgba(0,0,0,.06);
    z-index: 1;
  }
}

.sortable-header { cursor: pointer;
user-select: none; }
                .sortable-header:hover { background-color: #f8f9fa;
}
                /* Unicode-Pfeile für auf/ab */
                .sortable-header.sort-asc::after { content: ' \25B2';
font-size: 0.8em; }
                .sortable-header.sort-desc::after { content: ' \25BC';
font-size: 0.8em; }

/* * Responsive Navbar Text:
 * - Desktop XL (> 1200px): Text ist sichtbar.
 * - Desktop LG (992px - 1199px): Text ausblenden (nur Icon).
 * - Mobile (< 992px): Bootstrap's navbar-collapse greift (Hamburger-Menü).
 */
@media (min-width: 992px) and (max-width: 1199.98px) {
  .navbar-nav .nav-link .nav-link-text {
    display: none; /* Text ausblenden */
  }
  
  /* Icons zentrieren/anpassen, wenn Text weg ist */
  .navbar-nav .nav-link {
    text-align: center;
    padding-left: 0.5rem; 
    padding-right: 0.5rem;
  }
  
  /* Dropdown-Pfeil näher an das Icon rücken */
  .navbar-nav .dropdown-toggle::after {
      margin-left: 0.2em; 
  }

  /* Abstand zwischen Icon und (unsichtbarem) Text entfernen */
  .navbar-nav .nav-link i.me-1 {
    margin-right: 0 !important;
  }
}
</style>

<script>
  (function() {
    // --- Hier können Sie die Standards anpassen ---
    const DEFAULT_ZOOM = 0.9; // Standard-Zoom (in rem)
    const ZOOM_STEP = 0.05;   // Schrittweite pro Klick
    const MIN_ZOOM = 0.7;     // Minimaler Zoom
    const MAX_ZOOM = 1.2;     // Maximaler Zoom
    const STORAGE_KEY = 'globalZoomLevel';
    // ----------------------------------------------

    // Funktion, die den Zoom auf das <html>-Element anwendet
    function applyZoom(size) {
      const zoomSize = parseFloat(size).toFixed(2);
      document.documentElement.style.fontSize = zoomSize + 'rem';
    }

    // Funktion, die den aktuellen Wert aus dem Speicher holt
    function getCurrentZoom() {
      const storedSize = localStorage.getItem(STORAGE_KEY);
      return parseFloat(storedSize || DEFAULT_ZOOM);
    }

    // Funktion zum Vergrößern
    function zoomIn() {
      let currentSize = getCurrentZoom();
      currentSize = Math.min(MAX_ZOOM, currentSize + ZOOM_STEP);
      localStorage.setItem(STORAGE_KEY, currentSize);
      applyZoom(currentSize);
    }

    // Funktion zum Verkleinern
    function zoomOut() {
      let currentSize = getCurrentZoom();
      currentSize = Math.max(MIN_ZOOM, currentSize - ZOOM_STEP);
      localStorage.setItem(STORAGE_KEY, currentSize);
      applyZoom(currentSize);
    }

    // 1. Zoom beim Laden der Seite sofort anwenden (verhindert "flackern")
    applyZoom(getCurrentZoom());

    // 2. Event-Listener an die Knöpfe hängen, sobald das HTML geladen ist
    document.addEventListener('DOMContentLoaded', () => {
      const zoomInBtn = document.getElementById('zoom-in-btn');
      const zoomOutBtn = document.getElementById('zoom-out-btn');

      if (zoomInBtn) {
        zoomInBtn.addEventListener('click', zoomIn);
      }
      if (zoomOutBtn) {
        zoomOutBtn.addEventListener('click', zoomOut);
      }

      // --- NEU: Admin-Menü-Link je nach Rolle ein-/ausblenden ---
          try {
            const token = localStorage.getItem('jwtToken'); // Annahme: Token-Schlüssel ist 'token'
            const usersNavLink = document.getElementById('nav-users-link');
            const settingsNavLink = document.getElementById('nav-settings-link');

            if (!usersNavLink) return; // Element nicht gefunden

            if (token) {
              // Token-Payload extrahieren und decodieren
              const payloadBase64Url = token.split('.')[1];
              const payloadBase64 = payloadBase64Url.replace(/-/g, '+').replace(/_/g, '/');
              const payloadJson = decodeURIComponent(atob(payloadBase64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
              }).join(''));
              
              const payload = JSON.parse(payloadJson);
              
              // Sichtbarkeit basierend auf der Rolle steuern
              if (payload.role !== 'admin') {
                usersNavLink.style.display = 'none';
                settingsNavLink.style.display = 'none';
              }
              // (Wenn 'admin', bleibt es sichtbar)

            } else {
              // Kein Token gefunden (nicht eingeloggt) -> Menü ausblenden
              usersNavLink.style.display = 'none';
              settingsNavLink.style.display = 'none';
            }
          } catch (e) {
            // Fehler beim Parsen (z.B. ungültiger Token) -> Vorsichtshalber ausblenden
            console.error('Rollenprüfung für Menü fehlgeschlagen:', e);
            const usersNavLink = document.getElementById('nav-users-link');
            const settingsNavLink = document.getElementById('nav-settings-link');
            if (usersNavLink) {
               usersNavLink.style.display = 'none';
            }
            if (settingsNavLink) {
               settingsNavLink.style.display = 'none';
            }
          }
    });
  })();
</script>

</head>
<body>
